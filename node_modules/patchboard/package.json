{
  "name": "patchboard",
  "description": "Patchboard API server and tools",
  "author": {
    "name": "Matthew King"
  },
  "version": "0.4.13",
  "repository": {
    "type": "git",
    "url": "https://github.com/automatthew/patchboard/"
  },
  "main": "./index.js",
  "bin": {
    "patchboard": "./bin/patchboard"
  },
  "files": [
    "index.js",
    "bin/",
    "src/",
    "schema.json"
  ],
  "dependencies": {
    "connect": "2.3.x",
    "marked": "0.2.x",
    "c50n": "0.3.1",
    "jsck": "~0.1.4",
    "coffee-script": "1.7.1",
    "log4js": "~0.6.10",
    "fairmont": "~0.7.0"
  },
  "devDependencies": {
    "testify": "0.2.9"
  },
  "readme": "# Patchboard\n\nPatchboard streamlines the development of REST API services by using a serializable API definition that is easy to write and easy to read. With it, you can eliminate the repetition and brittleness involved in writing and maintaining an API provided a server and used by clients in multiple languages.\n\nGiven a description of your URLs, resources, and schemas, Patchboard provides a Node.js server that validates HTTP requests and dispatches them to resource handlers you define.  The server exposes the API Definition as JSON, which a Patchboard client can use to self-assemble the logic needed to interact with the API.\n\nBecause the API Definition is serializable, Patchboard clients that consume it at runtime can be implemented in any sufficiently dynamic language.  At this time, only a [JavaScript client][patchboard-js] has been written.\n\n\n## API Definition format\n\nExamples are excerpts from the [Trivial example][patchboard-trivial], which is written in CoffeeScript.\n\n### Mappings\n\nA dictionary that maps arbitrary logical names to resources and the URLs used to access them.\n\n```.coffee\n\nmodule.exports =\n\n  users:\n    resource: \"users\"\n    path: \"/users\"\n\n  user_search:\n    resource: \"user\"\n    path: \"/user\"\n    query:\n      login:\n        required: true\n        type: \"string\"\n\n  user:\n    resource: \"user\"\n    template: \"/users/:id\"\n```\n\n### Schemas\n\nA JSON Schema (currently limited to [draft 3][json-schema-3]) describing the data structures used by an API. Resource schemas are defined as properties of the top level `definitions` field.  \n\n\n```.coffee\n\nmedia_type = (name) ->\n  \"application/vnd.trivial.#{name}+json;version=1.0\"\n\nmodule.exports =\n\n  id: \"urn:patchboard.trivial\"\n  definitions:\n\n    resource:\n      extends: {$ref: \"urn:patchboard#resource\"}\n\n    user:\n      extends: {$ref: \"#resource\"}\n      mediaType: media_type \"user\"\n      properties:\n        login:\n          required: true\n          type: \"string\"\n          pattern: \"^[a-zA-z0-9_.]{3,32}\"\n        email:\n          type: \"string\"\n          format: \"email\"\n        password:\n          type: \"string\"\n          minLength: 4\n          maxLength: 64\n        questions: {$ref: \"#questions\"}\n```\n\n\n### Resources\n\nA dictionary describing the resources provided by the API.  Each top level field defines a resource.\n\nAn excerpt of the Trivial example:\n\n```.coffee\n\ntype = (name) ->\n  \"application/vnd.trivial.#{name}+json;version=1.0\"\n\nmodule.exports =\n  users:\n    actions:\n      create:\n        method: \"POST\"\n        request:\n          type: type \"user\"\n        response:\n          type: type \"user\"\n          status: 201\n\n  user_search:\n    actions:\n      get:\n        method: \"GET\"\n        response:\n          type: type \"user\"\n          status: 200\n\n  user:\n    actions:\n      get:\n        method: \"GET\"\n        response:\n          type: type \"user\"\n          status: 200\n      delete:\n        method: \"DELETE\"\n        response:\n          status: 204\n```\n\nFor each resource, the `actions` dictionary defines the available actions, specifying the HTTP method, the request and/or response media types, and the status that signifies a successful response.\n\n\n## Implementing a Patchboard Service\n\n## Validate your definition\n\nPatchboard includes a [JSON Schema][patchboard-def-schema] that describes a valid API Definition. A convenient way to validate your definition is to use `bin/patchboard`.\n\n    bin/patchboard validate path/to/api.json # or api.coffee, or api.js\n\nYou can also print a basic example definition to STDOUT.\n\n    bin/patchboard example json # or cson\n\n\n### Patchboard.Server\n\n```coffee\nPatchboard = require \"patchboard\"\napi = require \"./api\"\nhandlers = require \"./handlers\"\n\nserver = new Patchboard.Server api,\n  # Host and port to listen for HTTP requests\n  host: \"127.0.0.1\", port: 1979\n  # The base URL for resources\n  url: \"http://localhost:1979/\"\n  handlers: handlers\n\n```\n\n### Request Handlers\n\nThe request handler object is a dictionary of dictionaries.  The top level fields correspond to resource names, with the fields in the values mapping to actions.  For each resource + action, you define a function which takes a request [Context](#request-context) object as its argument.\n\nIn the following simplified example, the module exports a function which takes an application instance as its argument, then returns the handlers dictionary.\n\n```coffee\nmodule.exports = (application) ->\n\n  users:\n    create: (context) ->\n      {match, request} = context\n      content = request.body\n      application.create_user content, (error, result) -> \n        if error\n          context.error error.name, error.message\n        else\n          context.respond match.success_status, result\n\n  user:\n    get: (context) ->\n      application.get_user context.match.path.id, (error, result) ->\n        if error\n          context.error error.name, error.message\n        else\n          context.respond match.success_status, result\n    update: (context) ->\n      {match, request} = context\n      id = match.path.id\n      content = request.body\n      application.update_user id, content, (error, result) ->\n        if error\n          context.error error.name, error.message\n        else\n          context.respond match.success_status, result\n\n```\n\nNote that the callback passed to the application methods could easily be refactored into a function and used as the default for simple actions.\n\n### Request Context\n\nThe default Patchboard dispatcher calls handler functions with an instance of Context as an argument.  Contexts bundle together the objects representing the HTTP request and response, as well as providing helper functions such as `respond` and `error`\n\n\n## Using a Patchboard Client\n\nExample use of the JavaScript client (in CoffeeScript).\n\n```coffee\nClient = require(\"patchboard\").Client\n# or you can require \"patchboard-js\" directly\n\n# retrieve the API Definition from a Patchboard server and assemble a client.\nClient.discover \"http://localhost:1979/\", (error, client) ->\n  throw error if error\n  \n  client.resources.users.create {login: \"matthew\"}, (error, response) ->\n    throw error if error\n\n    user = response.resource\n    user.update {email: \"matthew@mail.com\"}, (error, response) ->\n\n```\n\n\n[patchboard-js]:https://github.com/automatthew/patchboard-js\n[json-schema-3]:http://tools.ietf.org/html/draft-zyp-json-schema-03\n[patchboard-trivial]:https://github.com/automatthew/patchboard-examples/tree/master/trivial\n[patchboard-def-schema]:https://github.com/automatthew/patchboard/blob/master/schema.json\n\n",
  "readmeFilename": "README.md",
  "_id": "patchboard@0.4.13",
  "_shasum": "8a1e557238d327522031e0a5b9265193d3da581f",
  "_from": "patchboard@",
  "_resolved": "https://registry.npmjs.org/patchboard/-/patchboard-0.4.13.tgz"
}
